<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–Ω–∞–ª—ñ–∑ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –£–≤–∞–≥–∏ YouTube</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background-color: #f8fafc;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .title {
            font-size: 2rem;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            color: #6b7280;
            margin-bottom: 5px;
        }
        
        .hint {
            font-size: 0.9rem;
            color: #9ca3af;
        }
        
        .grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        @media (min-width: 1024px) {
            .grid {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        .card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 16px;
        }
        
        .video-container {
            position: relative;
            width: 100%;
            height: 0;
            padding-bottom: 56.25%;
            margin-bottom: 16px;
        }
        
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 8px;
        }
        
        .current-time {
            text-align: center;
            padding: 12px;
            background-color: #f3f4f6;
            border-radius: 8px;
            font-size: 1.1rem;
        }
        
        .time-value {
            font-family: monospace;
            font-weight: bold;
            color: #2563eb;
        }
        
        .stats-grid {
            display: grid;
            gap: 16px;
        }
        
        .stat-item {
            padding: 16px;
            border-radius: 8px;
            border-left: 4px solid;
        }
        
        .stat-start {
            background-color: #eff6ff;
            border-left-color: #3b82f6;
        }
        
        .stat-middle {
            background-color: #fefce8;
            border-left-color: #eab308;
        }
        
        .stat-end {
            background-color: #fef2f2;
            border-left-color: #ef4444;
        }
        
        .stat-title {
            font-weight: 600;
            margin-bottom: 4px;
        }
        
        .stat-time {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 4px;
        }
        
        .stat-value {
            font-size: 1.1rem;
            font-weight: bold;
        }
        
        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .chart-wrapper {
            position: relative;
            height: 400px;
            margin-top: 20px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            background: #fafafa;
        }
        
        .chart-svg {
            width: 100%;
            height: 100%;
            background: white;
            border-radius: 8px;
        }
        
        .chart-line {
            fill: none;
            stroke: #2563eb;
            stroke-width: 3;
            cursor: pointer;
        }
        
        .chart-line:hover {
            stroke-width: 4;
        }
        
        .chart-current-line {
            stroke: #ef4444;
            stroke-width: 2;
            stroke-dasharray: 5,5;
        }
        
        .chart-dot {
            fill: #1d4ed8;
            stroke: white;
            stroke-width: 2;
            r: 4;
            opacity: 0;
            cursor: pointer;
        }
        
        .chart-dot:hover {
            opacity: 1;
            r: 6;
        }
        
        .chart-grid {
            stroke: #e5e7eb;
            stroke-width: 1;
        }
        
        .chart-axis {
            stroke: #666;
            stroke-width: 1;
        }
        
        .chart-text {
            font-size: 12px;
            fill: #666;
            text-anchor: middle;
        }
        
        .chart-label {
            font-size: 14px;
            font-weight: bold;
            fill: #333;
            text-anchor: middle;
        }
        
        .tooltip {
            position: absolute;
            background: white;
            border: 1px solid #ccc;
            padding: 8px;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            font-size: 14px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 1000;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            background-color: #eff6ff;
            border-radius: 12px;
            margin-top: 20px;
        }
        
        .footer p {
            margin-bottom: 8px;
            color: #6b7280;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">–Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —É–≤–∞–≥–∏</h1>
            <p class="subtitle">YouTube –≤—ñ–¥–µ–æ (9:40)</p>
            <p class="hint" id="status">üí° –ö–ª—ñ–∫–∞–π—Ç–µ –ø–æ –≥—Ä–∞—Ñ—ñ–∫—É –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥—É –¥–æ –º–æ–º–µ–Ω—Ç—É –≤—ñ–¥–µ–æ</p>
        </div>
        
        <div class="grid">
            <!-- YouTube –≤—ñ–¥–µ–æ -->
            <div class="card">
                <h2 class="card-title">üé• –í—ñ–¥–µ–æ</h2>
                <div class="video-container">
                    <iframe 
                        id="youtube-frame"
                        src="https://www.youtube.com/embed/Tnp-XWElTMU?enablejsapi=1&origin=*"
                        frameborder="0" 
                        allowfullscreen>
                    </iframe>
                </div>
                <div class="current-time">
                    ‚è∞ –ü–æ—Ç–æ—á–Ω–∏–π —á–∞—Å: <span class="time-value" id="current-time">0:00</span>
                </div>
            </div>
        
        <!-- –ì—Ä–∞—Ñ—ñ–∫ -->
        <div class="chart-container">
            <h2 class="card-title" style="text-align: center;">üìà –ì—Ä–∞—Ñ—ñ–∫ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —É–≤–∞–≥–∏</h2>
            <div class="chart-wrapper">
                <svg class="chart-svg" id="retentionChart"></svg>
                <div class="tooltip" id="tooltip"></div>
            </div>
        </div>
        
        <!-- –ü—ñ–¥–∫–∞–∑–∫–∞ -->
        <div class="footer">
            <p>üéØ <strong>–Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è:</strong> –ö–ª—ñ–∫–Ω—ñ—Ç—å –Ω–∞ –±—É–¥—å-—è–∫—É —Ç–æ—á–∫—É –≥—Ä–∞—Ñ—ñ–∫–∞, —â–æ–± –ø–µ—Ä–µ–π—Ç–∏ –¥–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ–≥–æ –º–æ–º–µ–Ω—Ç—É —É –≤—ñ–¥–µ–æ</p>
            <p>üì± –°–∞–π—Ç –∞–¥–∞–ø—Ç–æ–≤–∞–Ω–∏–π –¥–ª—è –º–æ–±—ñ–ª—å–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤</p>
        </div>
    </div>

    <script>
        // –î–∞–Ω—ñ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —É–≤–∞–≥–∏
        const audienceData = [
            {position: 0, retention: 99.5}, {position: 1, retention: 89.34}, {position: 2, retention: 82.27},
            {position: 3, retention: 76.36}, {position: 4, retention: 72}, {position: 5, retention: 69.02},
            {position: 6, retention: 67.46}, {position: 7, retention: 64.86}, {position: 8, retention: 63.48},
            {position: 9, retention: 63.03}, {position: 10, retention: 61.91}, {position: 11, retention: 59.73},
            {position: 12, retention: 58.15}, {position: 13, retention: 57.12}, {position: 14, retention: 55.04},
            {position: 15, retention: 54.02}, {position: 16, retention: 52.95}, {position: 17, retention: 51.24},
            {position: 18, retention: 47.9}, {position: 19, retention: 45.89}, {position: 20, retention: 44.29},
            {position: 21, retention: 43.51}, {position: 22, retention: 42.74}, {position: 23, retention: 42.22},
            {position: 24, retention: 41.67}, {position: 25, retention: 40.42}, {position: 26, retention: 39.65},
            {position: 27, retention: 38.98}, {position: 28, retention: 38.03}, {position: 29, retention: 36.79},
            {position: 30, retention: 35.76}, {position: 31, retention: 35.22}, {position: 32, retention: 34.82},
            {position: 33, retention: 34.66}, {position: 34, retention: 34.08}, {position: 35, retention: 33.69},
            {position: 36, retention: 33.33}, {position: 37, retention: 33.59}, {position: 38, retention: 33.73},
            {position: 39, retention: 31.87}, {position: 40, retention: 31.58}, {position: 41, retention: 31.48},
            {position: 42, retention: 31.21}, {position: 43, retention: 31.11}, {position: 44, retention: 30.9},
            {position: 45, retention: 30.51}, {position: 46, retention: 30.2}, {position: 47, retention: 30.18},
            {position: 48, retention: 30.1}, {position: 49, retention: 30.09}, {position: 50, retention: 29.87},
            {position: 51, retention: 29.47}, {position: 52, retention: 29.07}, {position: 53, retention: 28.94},
            {position: 54, retention: 28.77}, {position: 55, retention: 28.57}, {position: 56, retention: 28.44},
            {position: 57, retention: 28.25}, {position: 58, retention: 28.06}, {position: 59, retention: 28.03},
            {position: 60, retention: 27.98}, {position: 61, retention: 27.82}, {position: 62, retention: 27.65},
            {position: 63, retention: 27.38}, {position: 64, retention: 27.2}, {position: 65, retention: 26.97},
            {position: 66, retention: 26.95}, {position: 67, retention: 26.74}, {position: 68, retention: 26.56},
            {position: 69, retention: 28.33}, {position: 70, retention: 25.83}, {position: 71, retention: 25.58},
            {position: 72, retention: 25.53}, {position: 73, retention: 25.38}, {position: 74, retention: 25.35},
            {position: 75, retention: 25.16}, {position: 76, retention: 24.97}, {position: 77, retention: 24.61},
            {position: 78, retention: 24.33}, {position: 79, retention: 24.14}, {position: 80, retention: 24},
            {position: 81, retention: 23.93}, {position: 82, retention: 23.84}, {position: 83, retention: 23.77},
            {position: 84, retention: 23.69}, {position: 85, retention: 23.61}, {position: 86, retention: 23.55},
            {position: 87, retention: 23.39}, {position: 88, retention: 23.46}, {position: 89, retention: 23.43},
            {position: 90, retention: 23.57}, {position: 91, retention: 23.53}, {position: 92, retention: 23.68},
            {position: 93, retention: 23.62}, {position: 94, retention: 23.65}, {position: 95, retention: 23.11},
            {position: 96, retention: 22.68}, {position: 97, retention: 21.79}, {position: 98, retention: 20.99},
            {position: 99, retention: 20.87}
        ];

        const videoDurationSeconds = 9 * 60 + 40; // 9:40
        let currentVideoTime = 0;
        let currentLine = null;

        // –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è —á–∞—Å—É
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –≤—ñ–¥—Å–æ—Ç–∫—ñ–≤ —É —Å–µ–∫—É–Ω–¥–∏
        function percentToSeconds(percent) {
            return (percent / 100) * videoDurationSeconds;
        }

        // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è —Å–µ–∫—É–Ω–¥ —É –≤—ñ–¥—Å–æ—Ç–∫–∏
        function secondsToPercent(seconds) {
            return (seconds / videoDurationSeconds) * 100;
        }

        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ —á–∞—Å—É
        function updateCurrentTime(seconds) {
            currentVideoTime = seconds;
            document.getElementById('current-time').textContent = formatTime(seconds);
            updateCurrentLine(seconds);
        }

        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ª—ñ–Ω—ñ—ó –ø–æ—Ç–æ—á–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó
        function updateCurrentLine(seconds) {
            if (currentLine) {
                currentLine.remove();
            }
            
            const svg = document.getElementById('retentionChart');
            const rect = svg.getBoundingClientRect();
            const margin = 60;
            const chartWidth = rect.width - margin * 2;
            
            const currentPercent = secondsToPercent(seconds);
            const x = margin + (currentPercent / 100) * chartWidth;
            
            currentLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            currentLine.setAttribute('x1', x);
            currentLine.setAttribute('y1', 40);
            currentLine.setAttribute('x2', x);
            currentLine.setAttribute('y2', rect.height - 80);
            currentLine.setAttribute('class', 'chart-current-line');
            
            svg.appendChild(currentLine);
        }

        // –ü–µ—Ä–µ—Ö—ñ–¥ –¥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–∞—Å—É —É –≤—ñ–¥–µ–æ
        function seekToTime(seconds) {
            updateCurrentTime(seconds);
        }

        // –ü–æ–∫–∞–∑–∞—Ç–∏ tooltip
        function showTooltip(event, position, retention) {
            const tooltip = document.getElementById('tooltip');
            const timeLabel = formatTime(percentToSeconds(position));
            
            tooltip.innerHTML = `
                <div><strong>–ß–∞—Å: ${timeLabel}</strong></div>
                <div>–ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —É–≤–∞–≥–∏: ${retention.toFixed(2)}%</div>
                <div style="font-size: 12px; color: #666; margin-top: 4px;">–ö–ª—ñ–∫–Ω—ñ—Ç—å –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥—É</div>
            `;
            
            tooltip.style.left = (event.pageX + 10) + 'px';
            tooltip.style.top = (event.pageY - 10) + 'px';
            tooltip.style.opacity = '1';
        }

        // –°—Ö–æ–≤–∞—Ç–∏ tooltip
        function hideTooltip() {
            const tooltip = document.getElementById('tooltip');
            tooltip.style.opacity = '0';
        }

        // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è SVG –≥—Ä–∞—Ñ—ñ–∫–∞
        function createChart() {
            const svg = document.getElementById('retentionChart');
            if (!svg) {
                console.error('SVG element not found');
                return;
            }

            const rect = svg.getBoundingClientRect();
            if (rect.width === 0 || rect.height === 0) {
                // SVG —â–µ –Ω–µ –º–∞—î —Ä–æ–∑–º—ñ—Ä—É, —Å–ø—Ä–æ–±—É—î–º–æ –ø—ñ–∑–Ω—ñ—à–µ
                setTimeout(createChart, 100);
                return;
            }

            const width = rect.width;
            const height = rect.height;
            const margin = 60;
            const chartWidth = width - margin * 2;
            const chartHeight = height - margin * 2;

            // –û—á–∏—Å—Ç–∏—Ç–∏ SVG
            svg.innerHTML = '';

            // –°—Ç–≤–æ—Ä–∏—Ç–∏ –≤—Å—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ —É –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É
            let svgContent = '';

            // 1. –°—ñ—Ç–∫–∞
            for (let i = 0; i <= 10; i++) {
                const x = margin + (i / 10) * chartWidth;
                svgContent += `<line x1="${x}" y1="40" x2="${x}" y2="${height - 80}" class="chart-grid"/>`;
                svgContent += `<text x="${x}" y="${height - 60}" class="chart-text">${formatTime(percentToSeconds(i * 10))}</text>`;
            }

            for (let i = 0; i <= 8; i++) {
                const y = 40 + (i / 8) * chartHeight;
                const value = 20 + (8 - i) * 10;
                svgContent += `<line x1="${margin}" y1="${y}" x2="${width - margin}" y2="${y}" class="chart-grid"/>`;
                svgContent += `<text x="${margin - 10}" y="${y + 4}" class="chart-text" text-anchor="end">${value}%</text>`;
            }

            // 2. –û—Å—ñ
            svgContent += `<line x1="${margin}" y1="${height - 80}" x2="${width - margin}" y2="${height - 80}" class="chart-axis"/>`;
            svgContent += `<line x1="${margin}" y1="40" x2="${margin}" y2="${height - 80}" class="chart-axis"/>`;

            // 3. –ü—ñ–¥–ø–∏—Å–∏ –æ—Å–µ–π
            svgContent += `<text x="${width / 2}" y="${height - 20}" class="chart-label">–ß–∞—Å –≤—ñ–¥–µ–æ (—Ö–≤:—Å—Å)</text>`;
            svgContent += `<text x="20" y="${height / 2}" class="chart-label" transform="rotate(-90 20 ${height / 2})">–ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —É–≤–∞–≥–∏ (%)</text>`;

            // 4. –õ—ñ–Ω—ñ—è –≥—Ä–∞—Ñ—ñ–∫–∞
            let pathData = '';
            audienceData.forEach((point, index) => {
                const x = margin + (point.position / 100) * chartWidth;
                const y = 40 + chartHeight - ((point.retention - 20) / 80) * chartHeight;
                
                if (index === 0) {
                    pathData += `M ${x} ${y}`;
                } else {
                    pathData += ` L ${x} ${y}`;
                }
            });

            svgContent += `<path d="${pathData}" class="chart-line" style="cursor: pointer;"/>`;

            // 5. –ù–µ–≤–∏–¥–∏–º—ñ —Ç–æ—á–∫–∏ –¥–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó
            audienceData.forEach(point => {
                const x = margin + (point.position / 100) * chartWidth;
                const y = 40 + chartHeight - ((point.retention - 20) / 80) * chartHeight;
                svgContent += `<circle cx="${x}" cy="${y}" class="chart-dot" data-position="${point.position}" data-retention="${point.retention}"/>`;
            });

            // –î–æ–¥–∞—Ç–∏ –≤–µ—Å—å –∫–æ–Ω—Ç–µ–Ω—Ç –æ–¥—Ä–∞–∑—É
            svg.innerHTML = svgContent;

            // –î–æ–¥–∞—Ç–∏ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π –ø—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –µ–ª–µ–º–µ–Ω—Ç—ñ–≤
            setTimeout(() => {
                // –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è –∫–ª—ñ–∫—ñ–≤ –ø–æ –ª—ñ–Ω—ñ—ó
                const pathElement = svg.querySelector('path');
                if (pathElement) {
                    pathElement.addEventListener('click', (e) => {
                        const rect = svg.getBoundingClientRect();
                        const x = e.clientX - rect.left;
                        const percent = ((x - margin) / chartWidth) * 100;
                        
                        if (percent >= 0 && percent <= 100) {
                            const seconds = percentToSeconds(percent);
                            seekToTime(seconds);
                        }
                    });
                }

                // –û–±—Ä–æ–±–Ω–∏–∫–∏ –¥–ª—è —Ç–æ—á–æ–∫
                const circles = svg.querySelectorAll('.chart-dot');
                circles.forEach(circle => {
                    const position = parseFloat(circle.getAttribute('data-position'));
                    const retention = parseFloat(circle.getAttribute('data-retention'));
                    
                    circle.addEventListener('mouseenter', (e) => {
                        showTooltip(e, position, retention);
                    });
                    
                    circle.addEventListener('mouseleave', hideTooltip);
                    
                    circle.addEventListener('click', () => {
                        const seconds = percentToSeconds(position);
                        seekToTime(seconds);
                        hideTooltip();
                    });
                });
            }, 10);
        }

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('status').textContent = 'üìä –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≥—Ä–∞—Ñ—ñ–∫–∞...';
            
            setTimeout(() => {
                try {
                    createChart();
                    document.getElementById('status').textContent = 'üí° –ö–ª—ñ–∫–∞–π—Ç–µ –ø–æ –≥—Ä–∞—Ñ—ñ–∫—É –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥—É –¥–æ –º–æ–º–µ–Ω—Ç—É –≤—ñ–¥–µ–æ';
                } catch (error) {
                    console.error('Error creating chart:', error);
                    document.getElementById('status').textContent = '‚ö†Ô∏è –ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≥—Ä–∞—Ñ—ñ–∫–∞';
                }
            }, 100);

            // –ü–µ—Ä–µ–º–∞–ª—é–≤–∞—Ç–∏ –≥—Ä–∞—Ñ—ñ–∫ –ø—Ä–∏ –∑–º—ñ–Ω—ñ —Ä–æ–∑–º—ñ—Ä—É –≤—ñ–∫–Ω–∞
            window.addEventListener('resize', () => {
                setTimeout(createChart, 100);
            });
        });

        // –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫
        window.addEventListener('error', function(e) {
            console.error('Global error:', e.error);
            document.getElementById('status').textContent = '‚ö†Ô∏è –í–∏–Ω–∏–∫–ª–∞ –ø–æ–º–∏–ª–∫–∞, —Å–ø—Ä–æ–±—É–π—Ç–µ –æ–Ω–æ–≤–∏—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É';
        });
    </script>
</body>
</html>
